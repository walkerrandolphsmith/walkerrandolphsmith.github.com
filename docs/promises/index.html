<!DOCTYPE html>
  <html lang="en">
  <head>
      <title>Walker Randolph Smith</title>
      <meta name="description" content="From callbacks to promises." />
      <meta name="author" content="Walker Randolph Smith" />
      
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      
      <meta name="HandheldFriendly" content="True">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="canonical" href="http://walkerrandolphsmith.github.com/" />
      
      <link rel="amphtml" href="http://www.walkerrandolphsmith.com/promises-amp/">
      <link rel="alternate" type="application/rss+xml" title="Walker Randolph Smith" href="http://www.walkerrandolphsmith.com/rss/">
      
      <meta name="referrer" content="no-referrer-when-downgrade">
      
      <link rel="icon" type="image/png" href="http://www.walkerrandolphsmith.com/css/images/apple-icon-57x57.png" />
      <link rel="apple-touch-icon" sizes="57x57" href="http://www.walkerrandolphsmith.com/css/images/apple-icon-57x57.png" />
      <link rel="apple-touch-icon" sizes="72x72" href="http://www.walkerrandolphsmith.com/css/images/apple-icon-72x72.png" />
      <link rel="apple-touch-icon" sizes="114x114" href="http://www.walkerrandolphsmith.com/css/images/apple-icon-114x114.png" />
      <link rel="apple-touch-icon" sizes="144x144" href="http://www.walkerrandolphsmith.com/css/images/apple-icon-144x144.png" />
      
      <meta property="og:site_name" content="Walker Randolph Smith" />
      <meta property="og:title" content="Promises" />
      <meta property="og:type" content="article" />
      <meta property="og:url" content="http://www.walkerrandolphsmith.com/promises" />
      <meta property="og:description" content="From callbacks to promises." />
      <meta property="og:image" content="http://www.walkerrandolphsmith.com/css/images/heroes/default.jpg" />
      <meta property="og:image:width" content="1920">
      <meta property="og:image:height" content="1080">
      
      <meta name="twitter:card" content="summary_large_image">
      <meta name="twitter:title" content="Promises">
      <meta name="twitter:description" content="From callbacks to promises.">
      <meta name="twitter:url" content="http://www.walkerrandolphsmith.com/promises">
      <meta name="twitter:image" content="http://www.walkerrandolphsmith.com/css/images/heroes/default.jpg">
      <meta name="twitter:label1" content="Written by">
      <meta name="twitter:data1" content="Walker Randolph Smith">
      <link rel="stylesheet" href="http://www.walkerrandolphsmith.com/css/blogr.css">
  </head>
  <body>
    <header class="blog-info fixed hidden">
        <div class="title">
            <a href="http://www.walkerrandolphsmith.com"><img src="http://www.walkerrandolphsmith.com/css/images/logo-dark.png" class="retina" alt="Walker Randolph Smith"></a>
        </div>
        <nav class="main light">
            <ul>
                <li class="nav-amp" role="presentation"><a href=http://www.walkerrandolphsmith.com/promises-amp/><i class="fa fa-bolt"></i></a></li>
                <li class="nav-rss" role="presentation"><a href=http://www.walkerrandolphsmith.com/rss.xml><i class="fa fa-rss"></i></a></li>
                <li class="nav-home" role="presentation"><a href="http://www.walkerrandolphsmith.com">Home</a></li>
                <li class="nav-about-me" role="presentation"><a href="http://www.walkerrandolphsmith.com/resume/">R&eacute;sum&eacute;</a></li>
                <!--<li class="nav-projects" role="presentation"><a href="http://www.walkerrandolphsmith.com/projects/">Projects</a></li>-->
                <li class="nav-javascript" role="presentation"><a href="http://www.walkerrandolphsmith.com/tags/javascript/">JavaScript</a></li>
            </ul>
            <ul>
                <li class="option open">
                    <a href="http://www.walkerrandolphsmith.com" onclick="return false" class="showdrawer">
                        <i class="fa fa-navicon"></i>
                    </a>
                </li>
            </ul>
        </nav>    </header>
    <section class="drawer">
        <i class="fa fa-times close"></i>
    
        <section class="widget blog-info">
                <a href="http://www.walkerrandolphsmith.com">
                    <img src="http://www.walkerrandolphsmith.com/css/images/logo-dark.png" class="retina" alt="Walker Randolph Smith">
                </a>
            <hr>
            <p>
                Technology enthusiast, proud Eagle Scout, and software craftsman, I have a passion for the web and software development. I strive to adhere to Agile and SOLID principles while always maintaining a constant pursuit of improvement. My interests include UI/UX engineering, learning, and test driven development.
            </p>
        </section>
    
        <section class="widget navigation">
            <nav class="main-drawer">
                <ul>
                    <li class="nav-home" role="presentation"><a href="http://www.walkerrandolphsmith.com">Home</a></li>
                    <li class="nav-about-me" role="presentation"><a href="http://www.walkerrandolphsmith.com/resume/">R&eacute;sum&eacute;</a></li>
                    <li class="nav-projects" role="presentation"><a href="http://www.walkerrandolphsmith.com/projects/">Projects</a></li>
                    <li class="nav-javascript" role="presentation"><a href="http://www.walkerrandolphsmith.com/tags/javascript/">JavaScript</a></li>
                </ul>
            </nav>
        </section>
        <section class="widget subscribe">
            <div class="inner">
                <h3 class="title">My Newsletter</h3>
                <hr>
    
                <p>
                    Subscribe to my newsletter for updates on the evolution of the JavaScript toolchain.
                    <a href=http://www.walkerrandolphsmith.com/rss.xml><i class="fa fa-rss"></i></a> Currently updates are only available via RSS.
                </p>
                <i class="fa fa-envelope-o"></i>
    
                <!-- Begin MailChimp Form -->
                <div id="mc_embed_signup">
                    <form action="" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address </label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address...">
                            </div>
                            <div id="mce-responses" class="clear">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                            <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3c40623ce03f70afd7e8b6687_d572450014" tabindex="-1" value=""></div>
                            <div class="clear"><input type="submit" value="Subscribe" name="subscribe" disabled id="mc-embedded-subscribe" class="button"></div>
                        </div>
                    </form>
                </div>
                <!-- End MailChimp Form -->
    
            </div>
        </section>
        <section class="widget tags">
            <h3 class="title">Tags</h3>
            <hr>
            <div class="tags">
                    <a class="tag" href="http://www.walkerrandolphsmith.com/tags/javascript/" title="javascript">javascript (6)</a>
                    <a class="tag" href="http://www.walkerrandolphsmith.com/tags/electron/" title="electron">electron (1)</a>
                    <a class="tag" href="http://www.walkerrandolphsmith.com/tags/practices/" title="practices">practices (1)</a>
                    <a class="tag" href="http://www.walkerrandolphsmith.com/tags/versionone/" title="versionone">versionone (1)</a>
            </div>
        </section>
    
        <section class="widget themes">
            <h3 class="title">Themes</h3>
            <hr>
            <div class="dropdown">
                <select>
                    <option value="solarized">Solarized</option>
                    <option value="dark">Dark</option>
                    <option value="light">Light</option>
                </select>
                <div class="chevron">
                    <i class="fa fa-angle-down"></i>
                </div>
            </div>
            <div class="show-line-numbers">
                <p>Show Line Numbers:</p>
                <div class="checkbox">
                    <input type="checkbox" id="show-line-numbers" name="show-line-numbers" />
                    <label for="show-line-numbers"></label>
                </div>
            </div>
        </section>
    
        <section class="widget github-repos">
            <h3 class="title">Github</h3>
            <div class="pages">
                <span id="gh-prev">
                    <i class="fa fa-angle-left"></i>
                    Previous
                </span>
                <span id="gh-next">
                    Next
                    <i class="fa fa-angle-right"></i>
                </span>
            </div>
            <hr>
            <div id="gh-groups"></div>
        </section>
    
        <section class="widget bitbucket-repos">
            <h3 class="title">Bitbucket</h3>
            <div class="pages">
                <span id="bb-prev">
                    <i class="fa fa-angle-left"></i>
                    Previous
                </span>
                <span id="bb-next">
                    Next
                    <i class="fa fa-angle-right"></i>
                </span>
            </div>
            <hr>
            <div id="bb-groups"></div>
        </section>
    
        <section class="widget jsfiddle-repos">
            <h3 class="title">Js Fiddles</h3>
            <div class="pages">
                <span id="jsf-prev">
                    <i class="fa fa-angle-left"></i>
                    Previous
                </span>
                <span id="jsf-next">
                    Next
                    <i class="fa fa-angle-right"></i>
                </span>
            </div>
            <hr>
            <div id="jsf-groups"></div>
        </section>
    
        <section class="widget coderwall-repos">
            <h3 class="title">Badges</h3>
            <hr>
            <ul class="badges"></ul>
        </section>
    
        <section class="widget twitter">
            <h3 class="title">Twitter</h3>
            <hr>
            <a class="twitter-timeline"
               href="https://twitter.com/WalkerRSmith"
               data-tweet-limit="3"
               data-width="329"
               data-height="300"
               data-chrome="noheader nofooter noborders noscrollbar transparent"
               data-widget-id="398194465573052416"
               style="display: none;">
           </a>
        </section>
        <section class="widget copyright made-by">
            <p class="main">
                <span>Made with </span><i class="fa fa-heart"></i><span> by </span><a href="http://www.walkerrandolphsmith.com">Walker Randolph Smith</a>
            </p>
        </section>
    
    </section>    <main class="page-wrapper">
        <section class="hero hero-short">
            <div class="background"></div>
            <header class="blog-info transparent">
                <div class="title">
                    <a href="http://www.walkerrandolphsmith.com"><img src="http://www.walkerrandolphsmith.com/css/images/logo.png" class="retina" alt="Walker Randolph Smith"></a>
                </div>
                <nav class="main light">
                    <ul>
                        <li class="nav-amp" role="presentation"><a href=http://www.walkerrandolphsmith.com/promises-amp/><i class="fa fa-bolt"></i></a></li>
                        <li class="nav-rss" role="presentation"><a href=http://www.walkerrandolphsmith.com/rss.xml><i class="fa fa-rss"></i></a></li>
                        <li class="nav-home" role="presentation"><a href="http://www.walkerrandolphsmith.com">Home</a></li>
                        <li class="nav-about-me" role="presentation"><a href="http://www.walkerrandolphsmith.com/resume/">R&eacute;sum&eacute;</a></li>
                        <!--<li class="nav-projects" role="presentation"><a href="http://www.walkerrandolphsmith.com/projects/">Projects</a></li>-->
                        <li class="nav-javascript" role="presentation"><a href="http://www.walkerrandolphsmith.com/tags/javascript/">JavaScript</a></li>
                    </ul>
                    <ul>
                        <li class="option open">
                            <a href="http://www.walkerrandolphsmith.com" onclick="return false" class="showdrawer">
                                <i class="fa fa-navicon"></i>
                            </a>
                        </li>
                    </ul>
                </nav>            </header>
            <section class="post-item post-title center wrapper">
                <h1 class="title">Promises</h1>
                <ul class="meta">
                    <li class="date">
                        <a href="http://www.walkerrandolphsmith.com">
                            <time datetime="October 29, 2016">October 29, 2016</time>
                        </a>
                    </li>
                </ul>
                <p class="excerpt">
                    From callbacks to promises.
                </p>
                <a href="http://www.walkerrandolphsmith.com/resume/" class="author">
                    <img src="http://www.walkerrandolphsmith.com/css/images/logo.png" alt="Walker Randolph Smith" data-no-retina="true">
                    <span>Walker Randolph Smith</span>
                </a>
            </section>
        </section>

        <section id="article">
            <article class="post-contents">
            <h1>Promises</h1>
            <p>Asynchronous programming in Javascript involves a control flow that is not sequential like what is
expected from most programming languages. This non-sequence nature is due to the result of a function
not being available immediately. In this scenario the program continues execution despite the result of the first
function not returning and the subsequent operations on that result not occurring. Asynchronous code may be a result of
physical limitations causing the reults to not be instant or guaranteed like file IO and network requests.
Asynchronous programming can be a challenging task and it has evolved quite a bit in Javascript since I began programming.
In a few short years I have solved this problem like many other Javascript developers: using callbacks, promises, and now
even <code>async</code> and <code>await</code>. Each of these approaches changes the structure of the asynchronous code as well as the control flow.
For many people seeing the differences between these techniques will actually feel like a stroll down memory lane.</p>
<h2><a name="callbacks" class="anchor" href="#callbacks"></a>callbacks</h2><p>The first technique I learned involved a pattern called callbacks. This term describes a technique of invoking a “callback”
function that will operate on the results of an asynchronous function invocation when the result is available. As mentioned
file IO is a great example of asynchronous code. Consider reading a file from disk:</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">"my-file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="line-numbers-rows"><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>Unlike synchronous functions, <code>undefined</code> will be printed as contents because the file’s contents have not yet been read from disk.
However if we need to perform an action with contents of the file we can accomplish this with a callback function.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"File was read! "</span><span class="token punctuation">,</span> contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">"my-file"</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>In this example <code>action</code> is a callback function that will print the contents of the file when they have <strong>eventually</strong>
been retrieved. Understanding this code is not too difficult but is critical to understand the order in which things occur.
First the callback function, action, is declared. Then the <code>readFile</code> function is invoked. Immediately afterwards
<code>&quot;end&quot;</code> is printed to the console. Lastly the error or contents are printed to the console despite appearing
in the script prior to the last console statement. Callbacks allow us to handle asynchronous programming, great.
One common issue that occurs when using callbacks is described as <code>callback hell</code>. Often we find code in which
more asynchronous functions are called within the context of a callback function. Sticking with the file IO example lets
consider reading all files from a directory.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers">fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'my-dir'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> error<span class="token punctuation">;</span>
    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>file <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> err<span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>In this example a callback function is passed to <code>readdir</code> that performs some action once the directory has been read from disk.
Within that callback function, the retrieved files are iterated over and each read, which required another callback function
to handle the contents of the file read when the operation has completed. There are a few side effects of writing this code as
seen. It is very difficult to wrap the inner most callback function under test. Over shadowing of variables
like <code>error</code> become more likely. In this example I differentiated between the two with <code>error</code> and <code>err</code>. Is <code>readdirError</code>
and <code>readFileError</code> better? Likely not and the more nested asynchronous calls that are made the more difficult this naming
becomes. It also complicates the intention, read files from a directory, with the implementation details of doing so.
Lastly one common complaint of this code gives rise to the term callback hell, the further and further indentation of the callback functions.
The trail of <code>});</code> symbols at the end indicates how deeply nested this block has become. One solution to avoid this deep nesting is to
declare each callback function instead of using anonymous functions. This allows the function to be written with the same
indentation as the top level call to <code>readdir</code>.</p>
<h2><a name="promises" class="anchor" href="#promises"></a>promises</h2><p>A promise is an alternative construct that enables us to write more readable asynchronous code. Before the advent of ES2015 there
were many great node modules like <code>Q</code>, <code>bluebird</code>, <code>RSVP</code>, and many more that provided promises. Now Promise is a first class
citizen of the language. So what is a promise? It is merely a function that is passed the arguments resolve and reject.
The function is executed immediately by the Promise implementation, passing resolve and reject functions and after
some asynchronous work is complete the resolve or reject functions are called. As describe by MDN, a Promise is a proxy
for a value that has yet to be determined. A promise begins in a pending state and once the asynchronous call has completed
it is fulfilled with a value or rejected with an error. Upon its fulfillment or rejection a promise is ready to invoke a callback function.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> err<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://resource'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>The <code>then</code> and <code>catch</code> function also return a promise so calls to them can be chained.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://resource'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>text <span class="token operator">=</span><span class="token operator">></span> <span class="token function">convertToXML</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>xml <span class="token operator">=</span><span class="token operator">></span> <span class="token function">convertToJson</span><span class="token punctuation">(</span>xml<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err <span class="token operator">=</span><span class="token operator">></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>Often we find ourselves needing to wait for many asynchronous calls to be resolved before taking action. Consider
making a http request to a resource like the previous example and the response contained ids needed to make subsequent
http request for more detailed data. We can use <code>Promise.all</code> to ensure every promise has been fulfilled before invoking our
callback function by passing an array of promises and/or scalar values to the function.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://resource'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>text <span class="token operator">=</span><span class="token operator">></span> <span class="token function">convertToXML</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>xml <span class="token operator">=</span><span class="token operator">></span> <span class="token function">convertToJson</span><span class="token punctuation">(</span>xml<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>items <span class="token operator">=</span><span class="token operator">></span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
        items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">=</span><span class="token operator">></span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`http://resource/details/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err <span class="token operator">=</span><span class="token operator">></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><h2><a name="async-await" class="anchor" href="#async-await"></a>async await</h2><p>Now ES2016 has described a new language feature to help us handle promises with the keywords <code>async</code> and <code>await</code>!
A function can de decorated with the <code>async</code> keyword that indicates it returns a Promise.
It’s invocation can be decorated with the <code>await</code> keyword which allows us to read and write asynchronous code synchronously.
The await keyword indicates there is a blocking call and further execution will wait for the promises resolution.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token keyword">const</span> getItems <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://resource'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>In the previous example printing items is not <code>undefined</code>! Now we can write asynchronous code as if it were synchronous.
The subsequent lines are not executed until <code>getItems</code> has resolved or rejected the Promise.
In the case of a rejection the caller of getItems can be wrapped in a <code>try</code>/<code>catch</code> statement.</p>
<div class="code-wrapper"><pre class="language-js line-numbers"><code class="language-js line-numbers"><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Oh no an error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div><p>The synchronous structure has eliminated the every growing indentation of callback hell. Unfortunately this is not part
 of the ES2015 specification so in order to use this feature you’ll need a bit of configuration.
The async-await node module can be a good candidate if your environment does not support <code>generators</code> because the module
is built on node-fibers allowing a function to be suspended without blocking Node’s event loop. In my case I was already
using a JavaScript transpiler, Babel, and able to configure it with an additional plugin to get the new feature.
First I had to install the module using <code>npm install babel-plugin-transform-async-to-generator</code> and then update my babel configuration.</p>
<div class="code-wrapper"><pre class="language-none line-numbers"><code class="language-none line-numbers">{
  "plugins": ["transform-async-to-generator"]
}<span class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><i class="fa fa-copy"></i></div>
            </article>
            <div class="aside-wrapper">
                <aside class="natural">
                      <section id="toc">
                          <header>
                          <h3>In this Article</h3>
                          <i class="fa fa-plus expander"></i>
                          </header>
                          <ul>
                              <li>
                                 <a href="/promises#callbacks">callbacks</a>
                              </li>
                              <li>
                                 <a href="/promises#promises">promises</a>
                              </li>
                              <li>
                                 <a href="/promises#async-await">async await</a>
                              </li>
                          </ul>
                      </section>
                </aside>
            </div>
        </section>

        <section class="post-bottom wrapper">
          <div class="more-content">
              <section id="related-posts">
                <header><h3>Related Posts</h3></header>
                <ul>
                </ul>
              </section>
              <section id="recent-posts">
                  <header><h3>Recent Posts</h3></header>
                  <ul>
                      <li>
                          <a href="http://www.walkerrandolphsmith.com/promises" title="promises">Promises</a>
                      </li>
                      <li>
                          <a href="http://www.walkerrandolphsmith.com/array" title="array">Array</a>
                      </li>
                      <li>
                          <a href="http://www.walkerrandolphsmith.com/pair-programming" title="pair-programming">Pair Programming</a>
                      </li>
                      <li>
                          <a href="http://www.walkerrandolphsmith.com/electron-native-apps" title="electron-native-apps">Electron Native Apps</a>
                      </li>
                      <li>
                          <a href="http://www.walkerrandolphsmith.com/versionone-javascript-sdk" title="versionone-javascript-sdk">VersionOne JavaScript SDK</a>
                      </li>
                  </ul>
              </section>
          </div>
          <div class="info">
              <div class="tags">
                    <a class="tag" href="http://www.walkerrandolphsmith.com/tags/javascript/" title="javascript">javascript</a>
              </div>
              <div class="categories">

              </div>
          </div>
          <div class="share-options">
              <a href="http://www.walkerrandolphsmith.com/promises/" class="permalink">http://www.walkerrandolphsmith.com/promises/</a>
              <ul class="share-buttons">
                  <li>Share:</li>
                  <li>
                    <a class="facebook"
                       href="https://www.facebook.com/sharer/sharer.php?u=http://www.walkerrandolphsmith.com/promises/"
                       onclick="window.open(this.href, 'facebook-share', 'width=490,height=530');return false;">
                       <i class="fa fa-facebook"></i>
                    </a>
                  </li>
                  <li>
                    <a class="linkedin"
                       href="http://www.linkedin.com/shareArticle?mini=true&url=http://www.walkerrandolphsmith.com/promises/&title=promises"
                       onclick="window.open(this.href, 'linkedin-share', 'width=490,height=530');return false;">
                       <i class="fa fa-linkedin"></i>
                   </a>
                  </li>
                  <li>
                      <a class="twitter"
                         href="http://twitter.com/share?text=Promises&url=http://www.walkerrandolphsmith.com/promises/"
                         onclick="window.open(this.href, 'twitter-share', 'width=490,height=530');return false;">
                         <i class="fa fa-twitter"></i>
                      </a>
                  </li>
                  <li>
                    <a class="google-plus"
                       href="https://plus.google.com/share?url=http://www.walkerrandolphsmith.com/promises/"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                        <i class="fa fa-google-plus"></i>
                    </a>
                  </li>

              </ul>
          </div>
        </section>
        <section class="widget author-profile">
            <div class="wrapper">
                <div class="info">
                    <a href="http://www.walkerrandolphsmith.com/resume/" class="profile gravatar">
                        <img src="http://www.walkerrandolphsmith.com/css/images/logo-dark.png" alt="Walker Randolph Smith" data-no-retina="true">
                    </a>
                    <div class="meta">
                        <span class="title">Author</span>
                        <h3><a href="http://www.walkerrandolphsmith.com/resume/">Walker Randolph Smith</a></h3>
                    </div>
                </div>
                <p>
                    Technology enthusiast, proud Eagle Scout, and software craftsman, I have a passion for the web and software development. I strive to adhere to Agile and SOLID principles while always maintaining a constant pursuit of improvement. My interests include UI/UX engineering, learning, and test driven development.
                </p>
            </div>
        </section>
        <section class="comments">
            <section class="comments-header" id="comments">
                <div class="wrapper">
                    <i class="fa fa-comments-o"></i>
                    <span class="title">Read comments</span>
                </div>
            </section>
            <section class="comment-stream">
                <div class="wrapper">
                    <div id="disqus_thread"></div>
                </div>
            </section>
        </section>
    </main>
    <footer class="post-info">
        <div class="meter">
            <span class="amount"></span>
        </div>
        <div class="default show">
            <a href="http://www.walkerrandolphsmith.com/resume/" class="author left">
                <img src="http://www.walkerrandolphsmith.com/css/images/logo-dark.png" alt="Walker Smith" data-no-retina="true">
                <div class="info">
                    <span>Walker Randolph Smith</span>
                    <span class="title">
                        <time datetime="October 29, 2016">October 29, 2016</time>
                    </span>
                </div>
            </a>
            <span class="back-to-top"><i class="fa fa-chevron-up"></i></span>
            <span class="post-more-content-shortcut right">
                <div class="info">
                    <span id="comment">
                        <i class="fa fa-comments-o"></i>
                        <span>Comments</span>
                    </span>
                    <span id="share">
                        <i class="fa fa-share"></i>
                        <span>Share</span>
                    </span>
                </div>
            </span>
        </div>
        <div class="related-posts">
            <span class="left"></span>
            <span class="back-to-top"><i class="fa fa-chevron-up"></i></span>
            <a href="http://www.walkerrandolphsmith.com/array/" class="next-post right">
                <div class="info">
                    <span>Next Post</span>
                    <span class="title">Array</span>
                </div>
                <i class="arrow right" alt="Array" data-no-retina="true"></i>
            </a>
        </div>
    </footer>
    <script src="http://www.walkerrandolphsmith.com/post.js" type="text/javascript"></script>
  </body>
</html>